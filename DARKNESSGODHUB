--// Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UIS = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

--// Variables
local aimEnabled = false
local aimbotTarget = nil
local aimPart = "HumanoidRootPart"
local aimRange = 50
local aimMinDot = 0.5

--// OrionLib Window
local success, OrionLib = pcall(function()
    return loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Orion/main/source"))()
end)

if not success then
    warn("KhÃ´ng táº£i Ä‘Æ°á»£c OrionLib")
    return
end

local Window = OrionLib:MakeWindow({Name = "TSB HUB", HidePremium = false, SaveConfig = false})
local MainTab = Window:MakeTab({Name = "Main", Icon = "rbxassetid://4483345998", PremiumOnly = false})

--// Aimlock Toggle
MainTab:AddToggle({
    Name = "Aim Lock",
    Default = false,
    Callback = function(Value)
        aimEnabled = Value
    end    
})

--// Close UI Button
MainTab:AddButton({
    Name = "ÄÃ³ng UI",
    Callback = function()
        OrionLib:Destroy()
    end    
})

OrionLib:Init()

--// UI Dropdown & Animation
local screenGui = Instance.new("ScreenGui", LocalPlayer:WaitForChild("PlayerGui"))
local frame = Instance.new("Frame", screenGui)
frame.Size = UDim2.new(0, 350, 0, 220)
frame.Position = UDim2.new(0.5, -175, 0.5, -110)
frame.BackgroundColor3 = Color3.fromRGB(40, 40, 70)
frame.Visible = true
frame.ClipsDescendants = true

local UIListLayout = Instance.new("UIListLayout", frame)

-- Dropdown
local dropdown = Instance.new("TextButton", frame)
dropdown.Size = UDim2.new(0.9, 0, 0, 30)
dropdown.Position = UDim2.new(0.05, 0, 0, 10)
dropdown.Text = "Chá»n ngÆ°á»i chÆ¡i"
dropdown.BackgroundColor3 = Color3.fromRGB(50, 50, 80)
dropdown.TextColor3 = Color3.fromRGB(255,255,255)
Instance.new("UICorner", dropdown).CornerRadius = UDim.new(0, 6)

local dropFrame = Instance.new("Frame", frame)
dropFrame.Size = UDim2.new(0.9, 0, 0, 150)
dropFrame.Position = UDim2.new(0.05, 0, 0, 40)
dropFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 90)
dropFrame.Visible = false
Instance.new("UICorner", dropFrame).CornerRadius = UDim.new(0, 6)

local selectedPlayer = nil
local function refreshPlayerList()
    dropFrame:ClearAllChildren()
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer then
            local btn = Instance.new("TextButton", dropFrame)
            btn.Size = UDim2.new(1, 0, 0, 25)
            btn.Text = player.Name
            btn.Font = Enum.Font.Gotham
            btn.TextSize = 14
            btn.BackgroundColor3 = Color3.fromRGB(50, 50, 80)
            btn.TextColor3 = Color3.fromRGB(255,255,255)
            btn.MouseButton1Click:Connect(function()
                selectedPlayer = player
                dropdown.Text = "ðŸ•½ï¸ " .. player.Name
                dropFrame.Visible = false
            end)
        end
    end
end

dropdown.MouseButton1Click:Connect(function()
    dropFrame.Visible = not dropFrame.Visible
end)

refreshPlayerList()

--// Toggle GUI
local toggleGuiBtn = Instance.new("TextButton", frame)
toggleGuiBtn.Size = UDim2.new(0.8, 0, 0, 25)
toggleGuiBtn.Position = UDim2.new(0.1, 0, 0.8, 0)
toggleGuiBtn.Text = "ðŸ‘ áº¨n UI"
toggleGuiBtn.Font = Enum.Font.Gotham
toggleGuiBtn.TextSize = 14
toggleGuiBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 70)
toggleGuiBtn.TextColor3 = Color3.fromRGB(255,255,255)
Instance.new("UICorner", toggleGuiBtn).CornerRadius = UDim.new(0, 6)

local showGuiBtn = Instance.new("TextButton", screenGui)
showGuiBtn.Size = UDim2.new(0, 120, 0, 30)
showGuiBtn.Position = UDim2.new(0, 10, 1, -40)
showGuiBtn.Text = "ðŸ‘ Má»Ÿ láº¡i UI"
showGuiBtn.Font = Enum.Font.Gotham
showGuiBtn.TextSize = 14
showGuiBtn.BackgroundColor3 = Color3.fromRGB(40, 40, 70)
showGuiBtn.TextColor3 = Color3.fromRGB(255,255,255)
showGuiBtn.Visible = false
Instance.new("UICorner", showGuiBtn).CornerRadius = UDim.new(0, 6)

-- Animate Show/Hide
local function animateHide()
    frame.Visible = false
    showGuiBtn.Visible = true
end

local function animateShow()
    frame.Visible = true
    showGuiBtn.Visible = false
end

toggleGuiBtn.MouseButton1Click:Connect(animateHide)
showGuiBtn.MouseButton1Click:Connect(animateShow)

--// Aimlock Logic (chá»‰ trong game cá»§a báº¡n)
local function getTarget()
    local char = LocalPlayer.Character
    if not char or not char:FindFirstChild(aimPart) then return nil end
    local camCF = Camera.CFrame
    local closest, closestDot = nil, aimMinDot
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= LocalPlayer and plr.Character and plr.Character:FindFirstChild(aimPart) then
            local hrp = plr.Character[aimPart]
            local dir = (hrp.Position - camCF.Position).Unit
            local dot = dir:Dot(camCF.LookVector)
            local dist = (hrp.Position - char.HumanoidRootPart.Position).Magnitude
            if dot > closestDot and dist <= aimRange then
                closestDot = dot
                closest = hrp
            end
        end
    end
    return closest
end

RunService.RenderStepped:Connect(function()
    if aimEnabled then
        local target = getTarget()
        if target then
            Camera.CFrame = CFrame.new(Camera.CFrame.Position, target.Position)
        end
    end
end)

print("Game UI + Aimlock Hub loaded successfully!")
